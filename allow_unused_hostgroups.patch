Only in nagios-3.2.3/base: broker.o
Only in nagios-3.2.3/base: checks.o
Only in nagios-3.2.3/base: commands.o
Only in nagios-3.2.3/base: comments-base.o
diff -ur nagios-3.2.3.orig/base/config.c nagios-3.2.3/base/config.c
--- nagios-3.2.3.orig/base/config.c	2009-05-17 07:54:28.000000000 -0500
+++ nagios-3.2.3/base/config.c	2011-12-28 13:50:04.000000000 -0600
@@ -213,6 +213,8 @@
extern int              debug_verbosity;
extern unsigned long    max_debug_file_size;

+extern int		allow_unused_hostgroups;
+


/******************************************************************/
@@ -1333,6 +1335,8 @@
			continue;
		else if(strstr(input,"precached_object_file=")==input)
			continue;
+		else if(strstr(input,"allow_unused_hostgroups=")==input)
+			allow_unused_hostgroups=(atoi(value)>0)?TRUE:FALSE;

		/* we don't know what this variable is... */
		else{
Only in nagios-3.2.3/base: config.o
Only in nagios-3.2.3/base: downtime-base.o
Only in nagios-3.2.3/base: events.o
Only in nagios-3.2.3/base: flapping.o
Only in nagios-3.2.3/base: logging.o
Only in nagios-3.2.3/base: macros-base.o
Only in nagios-3.2.3/base: Makefile
Only in nagios-3.2.3/base: nagios
diff -ur nagios-3.2.3.orig/base/nagios.c nagios-3.2.3/base/nagios.c
--- nagios-3.2.3.orig/base/nagios.c	2010-10-03 22:56:55.000000000 -0500
+++ nagios-3.2.3/base/nagios.c	2011-12-28 13:50:04.000000000 -0600
@@ -239,6 +239,8 @@
int             date_format=DATE_FORMAT_US;
char            *use_timezone=NULL;

+int		allow_unused_hostgroups=DEFAULT_ALLOW_UNUSED_HOSTGROUPS;
+
int             command_file_fd;
FILE            *command_file_fp;
int             command_file_created=FALSE;
Only in nagios-3.2.3/html: config.inc.php
Only in nagios-3.2.3/html: Makefile
Only in nagios-3.2.3/include: cgiutils.h
Only in nagios-3.2.3/include: config.h
Only in nagios-3.2.3/include: locations.h
diff -ur nagios-3.2.3.orig/include/nagios.h nagios-3.2.3/include/nagios.h
--- nagios-3.2.3.orig/include/nagios.h	2008-12-14 08:52:23.000000000 -0600
+++ nagios-3.2.3/include/nagios.h	2011-12-28 13:50:04.000000000 -0600
@@ -133,6 +133,8 @@
#define BASE_UPDATE_CHECK_RETRY_INTERVAL                        60*60*1  /* 1 hour base retry interval */
#define UPDATE_CHECK_RETRY_INTERVAL_WOBBLE                      60*60*3  /* 3 hour wobble on top of base retry interval */

+#define DEFAULT_ALLOW_UNUSED_HOSTGROUPS				0	/* Do not allow unused hostgroups by default */	
+

/******************* LOGGING TYPES ********************/

Only in nagios-3.2.3/include: snprintf.h
Only in nagios-3.2.3: Makefile
Only in nagios-3.2.3/module: helloworld.o
Only in nagios-3.2.3/module: Makefile
Only in nagios-3.2.3: pkginfo
Only in nagios-3.2.3/sample-config: cgi.cfg
Only in nagios-3.2.3/sample-config: httpd.conf
Only in nagios-3.2.3/sample-config: mrtg.cfg
Only in nagios-3.2.3/sample-config: nagios.cfg
Only in nagios-3.2.3/sample-config: resource.cfg
Only in nagios-3.2.3/sample-config/template-object: commands.cfg
Only in nagios-3.2.3/sample-config/template-object: contacts.cfg
Only in nagios-3.2.3/sample-config/template-object: localhost.cfg
Only in nagios-3.2.3/sample-config/template-object: printer.cfg
Only in nagios-3.2.3/sample-config/template-object: switch.cfg
Only in nagios-3.2.3/sample-config/template-object: templates.cfg
Only in nagios-3.2.3/sample-config/template-object: timeperiods.cfg
Only in nagios-3.2.3/sample-config/template-object: windows.cfg
Only in nagios-3.2.3: subst
Only in nagios-3.2.3/t: Makefile
Only in nagios-3.2.3/t-tap: Makefile
Only in nagios-3.2.3/xdata: Makefile
diff -ur nagios-3.2.3.orig/xdata/xodtemplate.c nagios-3.2.3/xdata/xodtemplate.c
--- nagios-3.2.3.orig/xdata/xodtemplate.c	2010-03-29 09:51:38.000000000 -0500
+++ nagios-3.2.3/xdata/xodtemplate.c	2011-12-28 13:51:51.000000000 -0600
@@ -124,6 +124,8 @@

int presorted_objects=FALSE;

+extern int allow_unused_hostgroups;
+
/*
 * Macro magic used to determine if a service is assigned
 * via hostgroup_name or host_name. Those assigned via host_name
@@ -5180,6 +5182,7 @@
	int result=OK;
	xodtemplate_service *temp_service=NULL;
	xodtemplate_memberlist *temp_memberlist=NULL;
+	xodtemplate_memberlist *temp_rejectlist=NULL;
	xodtemplate_memberlist *this_memberlist=NULL;
	char *host_name=NULL;
	int first_item=FALSE;
@@ -5192,6 +5195,25 @@
		if(temp_service->hostgroup_name==NULL && temp_service->host_name==NULL)
			continue;

+		/* If hostgroup is not null and hostgroup has no members, check to see if */
+		/* allow_unused_hostgroups is set to 1 - if it is, continue without error  */
+		if(temp_service->hostgroup_name!=NULL){
+			if(xodtemplate_expand_hostgroups(&temp_memberlist,&temp_rejectlist,temp_service->hostgroup_name,temp_service->_config_file,temp_service->_start_line)==ERROR){
+				return ERROR;
+			}
+			else{
+				xodtemplate_free_memberlist(&temp_rejectlist);
+				if (temp_memberlist!=NULL){
+					xodtemplate_free_memberlist(&temp_memberlist);
+				 	}
+				else{
+					/* User is ok with hostgroup -> service mappings with no services */
+					if(allow_unused_hostgroups==1)
+						continue;
+				}
+			}
+		}
+
		/* skip services that shouldn't be registered */
		if(temp_service->register_object==FALSE)
			continue;
@@ -5552,7 +5574,7 @@

		/* get list of master host names */
		master_hostlist=xodtemplate_expand_hostgroups_and_hosts(temp_hostdependency->hostgroup_name,temp_hostdependency->host_name,temp_hostdependency->_config_file,temp_hostdependency->_start_line);
-		if(master_hostlist==NULL){
+		if(master_hostlist==NULL && allow_unused_hostgroups==0){
#ifdef NSCORE
			logit(NSLOG_CONFIG_ERROR,TRUE,"Error: Could not expand master hostgroups and/or hosts specified in host dependency (config file '%s', starting on line %d)\n",xodtemplate_config_file_name(temp_hostdependency->_config_file),temp_hostdependency->_start_line);
#endif
@@ -5561,7 +5583,7 @@

		/* get list of dependent host names */
		dependent_hostlist=xodtemplate_expand_hostgroups_and_hosts(temp_hostdependency->dependent_hostgroup_name,temp_hostdependency->dependent_host_name,temp_hostdependency->_config_file,temp_hostdependency->_start_line);
-		if(dependent_hostlist==NULL){
+		if(dependent_hostlist==NULL && allow_unused_hostgroups==0){
#ifdef NSCORE
			logit(NSLOG_CONFIG_ERROR,TRUE,"Error: Could not expand dependent hostgroups and/or hosts specified in host dependency (config file '%s', starting on line %d)\n",xodtemplate_config_file_name(temp_hostdependency->_config_file),temp_hostdependency->_start_line);
#endif
@@ -5698,7 +5720,7 @@
#endif

			master_hostlist=xodtemplate_expand_hostgroups_and_hosts(temp_servicedependency->hostgroup_name,temp_servicedependency->host_name,temp_servicedependency->_config_file,temp_servicedependency->_start_line);
-			if(master_hostlist==NULL){
+			if(master_hostlist==NULL && allow_unused_hostgroups==0){
#ifdef NSCORE
				logit(NSLOG_CONFIG_ERROR,TRUE,"Error: Could not expand master hostgroups and/or hosts specified in service dependency (config file '%s', starting on line %d)\n",xodtemplate_config_file_name(temp_servicedependency->_config_file),temp_servicedependency->_start_line);
#endif
@@ -5883,7 +5905,7 @@
		if(temp_servicedependency->dependent_host_name!=NULL || temp_servicedependency->dependent_hostgroup_name!=NULL){

			dependent_hostlist=xodtemplate_expand_hostgroups_and_hosts(temp_servicedependency->dependent_hostgroup_name,temp_servicedependency->dependent_host_name,temp_servicedependency->_config_file,temp_servicedependency->_start_line);
-			if(dependent_hostlist==NULL){
+			if(dependent_hostlist==NULL && allow_unused_hostgroups==0){
#ifdef NSCORE
				logit(NSLOG_CONFIG_ERROR,TRUE,"Error: Could not expand dependent hostgroups and/or hosts specified in service dependency (config file '%s', starting on line %d)\n",xodtemplate_config_file_name(temp_servicedependency->_config_file),temp_servicedependency->_start_line);
#endif
